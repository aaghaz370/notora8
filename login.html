<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Notora — Login</title>
  <link rel="icon" href="images/logo.png" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/1c020da525.js" crossorigin="anonymous"></script>

  <style>
    :root{
      --bg:#070707;
      --card:#121212;
      --muted:#bdbdbd;
      --accent:#e50914;
      --accent-2:#ff3c3c;
      --glass: rgba(255,255,255,0.03);
      --radius:16px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:"Poppins",sans-serif;
      background: radial-gradient(ellipse at 10% 10%, rgba(229,9,20,0.06), transparent 10%), 
                  radial-gradient(ellipse at 90% 90%, rgba(255,60,60,0.03), transparent 10%), 
                  linear-gradient(180deg,#080808,#0b0b0b 30%);
      color:#fff;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
    }

    .wrap{
      width:100%;
      max-width:980px;
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:28px;
      align-items:center;
    }

    /* left hero */
    .left {
      padding:48px;
      border-radius:var(--radius);
      background: linear-gradient(180deg, rgba(255,0,0,0.02), transparent 30%);
      box-shadow: 0 8px 40px rgba(0,0,0,0.6);
      position:relative;
      overflow:hidden;
    }
    .logo-row{display:flex;align-items:center;gap:14px;margin-bottom:26px}
    .logo-row img{height:44px; width:44px; object-fit:contain; filter: drop-shadow(0 2px 6px rgba(229,9,20,0.25))}
    .brand { font-weight:800; font-size:1.8rem; color:var(--accent);}
    .hero-title{ font-size:2.4rem; font-weight:800; letter-spacing: -0.02em; margin-bottom:12px; color:#fff; text-shadow:0 6px 24px rgba(229,9,20,0.08)}
    .hero-sub{color:var(--muted); margin-bottom:26px; max-width:60%}

    .features{
      display:flex; gap:14px; flex-wrap:wrap;
    }
    .feature{
      background:var(--glass);
      border-radius:12px;
      padding:14px 16px;
      min-width:150px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
      display:flex; gap:10px; align-items:center;
    }
    .feature i{color:var(--accent); font-size:1.2rem}
    .feature small{color:var(--muted); font-weight:600}

    /* right card */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--radius);
      padding:26px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.6);
      width:100%;
      max-width:420px;
    }
    .mode-toggle{
      display:flex; gap:10px; justify-content:center; margin-bottom:18px;
    }
    .switch {
      display:inline-flex; gap:8px; align-items:center; background:transparent; border-radius:999px; padding:6px; border:1px solid rgba(255,255,255,0.03);
    }
    .switch button{
      background:transparent; color:var(--muted); border:none; padding:8px 12px; border-radius:12px; cursor:pointer; font-weight:700;
    }
    .switch .active{
      background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:white; box-shadow: 0 6px 18px rgba(229,9,20,0.2);
    }

    .form-row{display:flex; flex-direction:column; gap:12px;}
    .input{
      background: rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.03);
      padding:12px 14px;
      color:#fff;
      border-radius:10px;
      outline:none;
      transition: box-shadow .18s, transform .12s;
    }
    .input:focus{ box-shadow: 0 8px 28px rgba(229,9,20,0.12); transform:translateY(-2px) }
    .cta{
      background: linear-gradient(90deg,var(--accent),var(--accent-2));
      border:none;
      padding:12px 14px;
      border-radius:10px;
      color:white;
      font-weight:700;
      cursor:pointer;
      margin-top:6px;
      box-shadow: 0 10px 26px rgba(229,9,20,0.16);
    }
    .muted{ color:var(--muted); font-size:0.92rem; margin-top:8px; text-align:center}
    .row-between{ display:flex; justify-content:space-between; align-items:center; gap:12px}

    .link{
      color:var(--accent);
      text-decoration:none;
      font-weight:700;
      cursor:pointer;
    }

    .small-note{font-size:.9rem;color:var(--muted); margin-top:10px}

    .socials{display:flex; gap:12px; margin-top:14px; justify-content:center;}
    .socials a{width:44px;height:44px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02); color:var(--muted); text-decoration:none}
    .err{color:#ff8b8b; margin-top:8px; text-align:center}

    footer{ margin-top:16px; text-align:center; color:var(--muted); font-size:0.85rem}

    /* responsive */
    @media (max-width:920px){
      .wrap{ grid-template-columns: 1fr; }
      .hero-sub{ max-width:100%}
    }

  </style>
</head>
<body>

  <div class="wrap">
    <div class="left">
      <div class="logo-row">
        <img src="images/logo.png" alt="Notora logo" />
        <div class="brand">Notora</div>
      </div>

      <h1 class="hero-title">Unlock a world of free books</h1>
      <p class="hero-sub">Search, read and download — community-driven library with curated lists, top picks and personalized recommendations.</p>

      <div class="features">
        <div class="feature"><i class="fa-solid fa-magnifying-glass"></i><small>Smart search</small></div>
        <div class="feature"><i class="fa-solid fa-star"></i><small>Top curated</small></div>
        <div class="feature"><i class="fa-solid fa-user-friends"></i><small>Community uploads</small></div>
        <div class="feature"><i class="fa-solid fa-shield-halved"></i><small>Secure accounts</small></div>
      </div>

      <div style="height:16px"></div>
      <div class="small-note">By logging in you agree to Notora's Terms & Privacy. Your password is hashed securely on our backend.</div>

    </div>

    <!-- Card: Login/Register -->
    <div class="card" id="authCard">
      <div class="mode-toggle">
        <div class="switch" role="tablist">
          <button id="btnLogin" class="active">Login</button>
          <button id="btnRegister">Register</button>
        </div>
      </div>

      <div id="formContainer">
        <!-- LOGIN / REGISTER FORMS -->
        <div id="loginForm" style="display:block">
          <div class="form-row">
            <input id="email" class="input" type="email" placeholder="Email address" />
            <input id="password" class="input" type="password" placeholder="Password" />
            <div class="row-between">
              <label style="font-size:.9rem;color:var(--muted)"><input id="remember" type="checkbox" /> Remember</label>
              <a id="forgotLink" class="link">Forgot password?</a>
            </div>
            <button id="loginBtn" class="cta">Login</button>
            <div id="loginErr" class="err"></div>
            <div class="muted">Don't have an account? <span id="gotoRegister" class="link">Register</span></div>
          </div>
        </div>

        <div id="registerForm" style="display:none">
          <div class="form-row">
            <input id="regName" class="input" type="text" placeholder="Enter username (3-10 chars)" />
            <input id="regEmail" class="input" type="email" placeholder="Email address" />
            <input id="regPass" class="input" type="password" placeholder="Create password (min 6)" />
            <button id="registerBtn" class="cta">Create account</button>
            <div id="regErr" class="err"></div>
            <div class="muted">Already registered? <span id="gotoLogin" class="link">Login</span></div>
          </div>
        </div>
      </div>

      <div class="socials">
        <a href="#" title="YouTube"><i class="fa-brands fa-youtube"></i></a>
        <a href="#" title="Instagram"><i class="fa-brands fa-instagram"></i></a>
        <a href="#" title="Telegram"><i class="fa-brands fa-telegram"></i></a>
      </div>

      <footer>© Notora — Free learning library</footer>
    </div>

  </div>

<script>
  // ======== CONFIG ========
  const API_BASE = "https://notoraadminbackend-1.onrender.com/api/users"; // change if needed

  // ======== UI ========
  const btnLogin = document.getElementById('btnLogin');
  const btnRegister = document.getElementById('btnRegister');
  const loginForm = document.getElementById('loginForm');
  const registerForm = document.getElementById('registerForm');
  const gotoRegister = document.getElementById('gotoRegister');
  const gotoLogin = document.getElementById('gotoLogin');
  const forgotLink = document.getElementById('forgotLink');

  btnLogin.onclick = () => { showLogin(); }
  btnRegister.onclick = () => { showRegister(); }
  gotoRegister.onclick = () => showRegister();
  gotoLogin.onclick = () => showLogin();
  forgotLink.onclick = () => { window.location.href = 'forgot-password.html'; }

  function showLogin(){
    btnLogin.classList.add('active');
    btnRegister.classList.remove('active');
    loginForm.style.display='block';
    registerForm.style.display='none';
  }
  function showRegister(){
    btnRegister.classList.add('active');
    btnLogin.classList.remove('active');
    registerForm.style.display='block';
    loginForm.style.display='none';
  }

  // ======== AUTH LOGIC (safe, non-invasive) ========
  // login
  document.getElementById('loginBtn').addEventListener('click', async () => {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    const errNode = document.getElementById('loginErr');
    errNode.textContent='';
    if(!email || !password){ errNode.textContent='Please fill both fields.'; return; }
    try{
      const res = await fetch(`${API_BASE}/login`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ email, password })
      });
      const data = await res.json();
      if(!res.ok) throw new Error(data.message || 'Login failed');
      localStorage.setItem('notoraUser', JSON.stringify(data.user));
      localStorage.setItem('notoraToken', data.token);
      // redirect to profile or main
      window.location.href = 'profile.html';
    }catch(e){
      console.error(e);
      errNode.textContent = e.message || 'Login error';
    }
  });

  // register
  document.getElementById('registerBtn').addEventListener('click', async () => {
    const name = document.getElementById('regName').value.trim();
    const email = document.getElementById('regEmail').value.trim();
    const password = document.getElementById('regPass').value.trim();
    const errNode = document.getElementById('regErr');
    errNode.textContent='';
    if(!name || !email || !password){ errNode.textContent='Please fill all fields.'; return; }
    const nameRegex = /^[A-Za-z0-9 ]{3,10}$/;
    if(!nameRegex.test(name)){ errNode.textContent='Name must be 3–10 chars, no special symbols.'; return; }
    try{
      const res = await fetch(`${API_BASE}/register`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ name, email, password })
      });
      const data = await res.json();
      if(!res.ok) throw new Error(data.message || 'Register failed');
      localStorage.setItem('notoraUser', JSON.stringify(data.user));
      localStorage.setItem('notoraToken', data.token);
      window.location.href = 'profile.html';
    }catch(e){
      console.error(e);
      errNode.textContent = e.message || 'Register error';
    }
  });

  // pre-fill when already logged in
  (function checkLogged(){
    const token = localStorage.getItem('notoraToken');
    if(token) {
      // quick attempt to open profile view
      // but we will not call backend here to avoid extra errors
    }
  })();
</script>

</body>
</html>
